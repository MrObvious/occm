---
sidebar: sidebar
permalink: task_manage_fsx_aws.html
keywords: amazon fsx for ontap, fsx, volumes, create volumes, discover volumes service for fsx, delete volumes, access key, secret key, region, working environment, aws transit gateway, cmk
summary: Cloud Manager enables you to create volumes in Amazon FSx for ONTAP. You can also discover  volumes that you have already created from the AWS Management Console and add them to a working environment.
---

= Create an Amazon FSx for ONTAP working environment
:hardbreaks:
:nofooter:
:icons: font
:linkattrs:
:imagesdir: ./media/

[.lead]
Cloud Manager enables you to create volumes for link:https://www.docs.aws.amazon.com/fsx/latest/ONTAPGuide/what-is-fsx-ontap.html[Amazon FSx for ONTAP]. You can also discover volumes that you have already created from the AWS Management Console and add them to a working environment.

== Create an Amazon FSx for ONTAP working environment

Regardless of whether you have already created volumes from the AWS Management Console, or if you just signed up for Amazon FSx for ONTAP and have no volumes, the first step is to create a working environment for the FSx for ONTAP volumes.

If you already have volumes in FSx for ONTAP, the volumes are automatically added to the new working environment. If you haven't added any volumes yet, you can do that after you create the new working environment.

//TIP: If you have subscriptions and volumes in multiple AWS regions, you need to perform this task for each region.

.Before you begin

Before creating your FSx for ONTAP working environment in Cloud Manager, you will need:

* An AWS access key and secret key for an IAM with FSx for ONTAP user permissions or existing FSx for ONTAP credentials created by the AWS IAM administrator.
+
https://docs.aws.amazon.com/general/latest/gr/aws-security-credentials.html[AWS security credentials]
+
https://docs.aws.amazon.com/IAM/latest/UserGuide/id_roles_create_for-user.html[AWS Documentation: Creating a Role to Delegate Permissions to an IAM User^]

* An link:task_setting_up_kms_fsx[active Customer Master Key (CMK)] with an IAM user role with FSx for ONTAP credentials.

* link:task_setting_up_transit_gateway_fsx.html[An AWS transit gateway for FSx for ONTAP] to enable access to the floating IPs from outside the VPC where FSx for ONTAP resides. Floating IP addresses are required for cluster, SVM, and protocol access.

* The AWS region where the FSx for ONTAP instance was created.

.Steps

. In Cloud Manager, add a new Working Environment, select the location *Amazon Web Services*, and click *Next*.

. To create a new FSx for ONTAP environment, select *Amazon FSx for ONTAP* and click *Next*.
+
image:screenshot_add_fsx_working_env.png[A screenshot of adding a working environment for Amazon FSx for ONTAP]
+
TIP: To have Cloud Manager discover an existing FSx for ONTAP environment, click *Click Here* to enter your credentials and select the AWS region and working environment. This completes the process and adds the working environment to the Canvas.

. You can select existing FSx for ONTAP credentials or create new credentials using your AWS access key and secret key. Click to verify your IAM policy for the IAM user adheres to FSx for ONTAP requirements.

. Provide information about your FSx for ONTAP instance:

.. Enter the Working Environment name you want to use.
.. Optionally, you can create tags by clicking the plus sign and entering a tag name and value.
.. Enter and confirm the ONTAP Cluster password you want to use.
.. Select the option to use the same password for your SVM user or set a different password.
.. Click *Next*.
+
image:screenshot_add_fsx_credentials.png[A screenshot of adding credentials for FSx for ONTAP]

. Provide region and VPC information:

.. Select a region and VPC with subnets in at least two Availability Zones so each node is in a dedicated Availability Zone.
.. Accept the default security group or select a different one.
.. Select an Availability Zone and subnet for each node.
.. Click *Next*.
+
image:screenshot_add_fsx_region.png[A screenshot of adding region and VPC for FSx for ONTAP]

. Optionally, enter the range you configured when you link:task_setting_up_transit_gateway_fsx.html[set up an AWS transit gateway^] to enable access to the floating IPs from outside the VPC where FSx for ONTAP resides. Click *Next* to continue.
+
image:screenshot_add_fsx_floatingIP.png[A screenshot of adding region and VPC for FSx for ONTAP]

. Select route tables that include routes to the floating IP addresses. If you have just one route table for the subnets in your VPC (the main route table), Cloud Manager automatically adds the floating IP addresses to that route table. Click *Next* to continue.
+
image:screenshot_add_fsx_route_table.png[A screenshot of selecting a route table for FSx for ONTAP]

. Accept the default AWS master key or click *Change Key* to select a different AWS Customer Master Key (CMK). For more information on CMK, see link:https://docs.netapp.com/us-en/occm/task_setting_up_kms.html[Setting up the AWS KMS]. Click *Next* to continue.
+
image:screenshot_add_fsx_encryption.png[A screenshot of setting the default master key for FSx for ONTAP]

. Configure your storage:

.. Select the throughput, capacity, and unit.
.. You can optionally specify an IOPS value. If you don't specify and IOPS value, Cloud Manager will set a default value based on 3 IOPS per GiB of the total capacity entered. For example, if you enter 2000 GiB for the total capacity and no value for the IOPS, the effective IOPS value will be set to 6000.
.. Click *Next*.
+
image:screenshot_add_fsx_storage_config.png[A screenshot of setting storage configuration for FSx for ONTAP]

. Review your configuration:

.. Click the tabs to review your ONTAP properties, provider properties, and networking configuration.
.. Click *Previous* to make changes to any settings.
.. Click *Add* to accept the settings and create your Working Environment.
+
image:screenshot_add_fsx_review.png[A screenshot of reviewing the settings for FSx for ONTAP]

.Result

Cloud Manager displays your FSx for ONTAP configuration on the Canvas page.

image:screenshot_add_fsx_cloud.png[A screenshot of Amazon FSx for ONTAP on the working environments page.]

If volumes already exist, the volumes are automatically added to the new working environment, as shown in the screenshot. You can add additional volumes from Cloud Manager.

If no volumes exist, you can create them now.
